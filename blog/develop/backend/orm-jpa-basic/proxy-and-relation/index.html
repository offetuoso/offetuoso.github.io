<!DOCTYPE html>
<html lang="ko-KR">

<head>
  <title>JPA í”„ë¡ì‹œì™€ ì—°ê´€ê´€ê³„ | offetuoso&#39;s Blog</title>


  <meta charset="UTF-8">
  
  <meta name="language" content="en">
  <meta name="description" content="í”„ë¡ì‹œì™€ ì—°ê´€ê°„ê³„">
  <meta name="keywords" content="ORM">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="google-site-verification" content="eiictgcSx2RHATKZuDBO51sg4TWwfugKXhNbcHglc9s" />
  <meta name="naver-site-verification" content="43f1272370146d6542d0e06375925b4eff0cd2c7" />
  
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9349865689631647"
     crossorigin="anonymous"></script>

  
  <meta property="og:type" content="website"> 
  <meta property="og:title" content="í”„ë¡ì‹œì™€ ì—°ê´€ê°„ê³„">
  <meta property="og:description" content="í”„ë¡ì‹œì™€ ì—°ê´€ê°„ê³„">
     
  
  

  <script src="/js/lib/jquery-3.6.0.js"></script>
  <script src="/js/lib/jquery-ui.js"></script>
  <script src="/js/lib/jquery.mark.min.js"></script>
  <script src="/js/lib/jquery.tmpl.min.js"></script>
  <script src="/js/lib/fuse.js"></script>
  <script src="/js/lib/hangul.js"></script>
  <script src="https://offetuoso.github.io/js/lib/search.js"></script>
  <script src="https://offetuoso.github.io/js/common.js"></script>

  <link type="text/css" rel="stylesheet" href="https://offetuoso.github.io/css/lib/jquery-ui.css"/>
  <link type="text/css" rel="stylesheet" href="https://offetuoso.github.io/css/lib/font-awesome/css/font-awesome.css"/>
  <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link type="text/css" rel="stylesheet" href="https://offetuoso.github.io/css/common.css"/>
	
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" />


  
  
    
 
  
  
  
  
  
  
    
    <link type="text/css" rel="stylesheet" href="/css/post.min.15ebf1946e251b09a344b466aef7ce435fd25b42f0d9b081e65d4f06e01b0df3.css" integrity="sha256-FevxlG4lGwmjRLRmrvfOQ1/SW0Lw2bCB5l1PBuAbDfM="/>
  
    
    <link type="text/css" rel="stylesheet" href="/css/custom.min.39af44cd0c1b68d7767f6b88a63dd3a7f20261a6fb5690bf47f7a7bb199fc392.css" integrity="sha256-Oa9EzQwbaNd2f2uIpj3Tp/ICYab7VpC/R/enuxmfw5I="/>
  
  
   
   
    

<script type="application/ld+json">
  
    {
      "@context" : "http://schema.org",
      "@type" : "BlogPosting",
      "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/offetuoso.github.io\/"
      },
      "articleSection" : "blog",
      "name" : "JPA í”„ë¡ì‹œì™€ ì—°ê´€ê´€ê³„",
      "headline" : "JPA í”„ë¡ì‹œì™€ ì—°ê´€ê´€ê³„",
      "description" : "í”„ë¡ì‹œì™€ ì—°ê´€ê°„ê³„",
      "inLanguage" : "en-US",
      "author" : "",
      "creator" : "",
      "publisher": "",
      "accountablePerson" : "",
      "copyrightHolder" : "",
      "copyrightYear" : "2022",
      "datePublished": "2022-01-19 00:00:00 \u002b0000 UTC",
      "dateModified" : "2022-01-19 00:00:00 \u002b0000 UTC",
      "url" : "https:\/\/offetuoso.github.io\/blog\/develop\/backend\/orm-jpa-basic\/proxy-and-relation\/",
      "wordCount" : "2566",
      "keywords" : ["ORM", "Blog"]
    }
  
  </script>
</head>

<body>
  <div class="popup search-popup local-search-popup" style="display: none;">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>


  <div class="burger__container">
  <div class="burger" aria-controls="navigation" aria-label="Menu">
    <div class="burger__meat burger__meat--1"></div>
    <div class="burger__meat burger__meat--2"></div>
    <div class="burger__meat burger__meat--3"></div>
  </div>
</div>
 
  <nav class="nav" id="navigation">
  <ul class="nav__list">
    
    
      <li>
	        <a  
	        
	        
	        href="/"
    				
	        >welcome !</a>
      </li>
    
      <li>
	        <a  class="active"
	         
	        
	        
	        href="/blog"
    				
	        >blog</a>
      </li>
    
      <li>
	        <a  
	        
	        
	        href="javascript:proceedsearch();"
	       	
	        >search</a>
      </li>
    
  </ul>
</nav>

  
  <main>
    
    

    <div class="flex-wrapper">
      <div class="post__container">
        <div class="post">
          <header class="post__header">
             
            	<div class="header-inner" style="background-image: url('/images/title/bg-jpa.png');">
            
			      <div class="overlay" style="opacity:   0.4 ;"></div>
				<div class="page-heading">
		             <h1 class="post__title" style="color:white;font-size: 28px;">
		            	JPA í”„ë¡ì‹œì™€ ì—°ê´€ê´€ê³„
		              </h1>
		        </div>	
	        </div>
	        <h1 class="post__title" id="post__title" style="  display:none; ">
		       	JPA í”„ë¡ì‹œì™€ ì—°ê´€ê´€ê³„
            </h1>		
            <time datetime="2022-01-19 00:00:00 &#43;0000 UTC" class="post__date">2022-01-19</time> 
          </header>
          <article class="post__content">
              
<h1 id="í”„ë¡ì‹œì™€-ìƒì†ê´€ê³„">í”„ë¡ì‹œì™€ ìƒì†ê´€ê³„</h1>
<hr>
<h2 id="ëª©ì°¨">ëª©ì°¨<a class="anchor" href="#ëª©ì°¨">#</a></h2>
<hr>
<blockquote>
<ul>
<li>í”„ë¡ì‹œ</li>
<li>ì¦‰ì‹œ ë¡œë”©ê³¼ ì§€ì—° ë¡œë”©</li>
<li>ì§€ì—° ë¡œë”© í™œìš©</li>
<li>ì˜ì†ì„± ì „ì´ : CASCADE</li>
<li>ê³ ì•„ ê°ì²´</li>
<li>ì˜ì†ì„± ì „ì´ + ê³ ì•„ê°ì²´, ìƒëª…ì£¼ê¸°</li>
</ul>
</blockquote>
<h3 id="í”„ë¡ì‹œ">í”„ë¡ì‹œ<a class="anchor" href="#í”„ë¡ì‹œ">#</a></h3>
<hr>
<h4 id="memberë¥¼-ì¡°íšŒí• ë•Œ-teamë„-í•¨ê»˜-ì¡°íšŒí•´ì•¼-í• ê¹Œ">Memberë¥¼ ì¡°íšŒí• ë•Œ Teamë„ í•¨ê»˜ ì¡°íšŒí•´ì•¼ í• ê¹Œ?<a class="anchor" href="#memberë¥¼-ì¡°íšŒí• ë•Œ-teamë„-í•¨ê»˜-ì¡°íšŒí•´ì•¼-í• ê¹Œ">#</a></h4>
<p><img src="/images/develop/backend/orm-jpa-basic/proxy-and-relation/img-001.png" alt="contact"></p>
<blockquote>
<p>JpaMain.java</p>
</blockquote>
<pre><code>    private static void printMember(Member member){
        System.out.println(&quot;username = &quot;+member.getUsername());
    }

    private static void printMemberAndTeam(Member member){
        String username = member.getUsername();
        System.out.println(&quot;username = &quot;+username);

        Team team = member.getTeam();
        System.out.println(&quot;team = &quot;+team.getName());
    }
</code></pre>
<blockquote>
<p>Memberê°ì²´ë¥¼ ì¶œë ¥í•˜ëŠ” ë©”ì„œë“œì™€ Memberê°ì²´ì™€ Memberê°€ ê°€ì§€ëŠ” Team ê°ì²´ë¥¼ ì¶œë ¥í•˜ëŠ” ë©”ì„œë“œê°€ ìˆì„ë•Œ, Memberë§Œ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ë¥¼ ìˆ˜í–‰í• ë•Œ Teamê¹Œì§€ Joinì„ í†µí•˜ì—¬ ì¡°íšŒ ì¿¼ë¦¬ë¥¼ ìˆ˜í–‰í•œë‹¤ë©´ ìì›ë‚­ë¹„ì´ë‹¤.<br>
JPAëŠ” ì§€ì—°ë¡œë”©ê³¼ Proxyë¥¼ ì´ìš©í•˜ì—¬ ì´ê²ƒì„ í•´ê²°í•©ë‹ˆë‹¤.</p>
</blockquote>
<h4 id="í”„ë¡ì‹œ-ê¸°ì´ˆ">í”„ë¡ì‹œ ê¸°ì´ˆ<a class="anchor" href="#í”„ë¡ì‹œ-ê¸°ì´ˆ">#</a></h4>
<blockquote>
<ul>
<li>em.find() vs <mark>em.getRefernce()</mark></li>
<li>em.find() : ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í†µí•´ì„œ ì‹¤ì œ ì—”í‹°í‹° ê°ì²´ ì¡°íšŒ</li>
<li>em.getRefernce() : <mark>ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒë¥¼ ë¯¸ë£¨ëŠ” ê°€ì§œ(í”„ë¡ì‹œ) ì—”í‹°í‹° ê°ì²´ ì¡°íšŒ</mark></li>
</ul>
</blockquote>
<blockquote>
<p>Member.java -  Team ì´ì™¸ì˜ ë‹¤ë¥¸ ì—°ê´€ê´€ê³„ ì œê±°</p>
</blockquote>
<pre><code>package relativemapping;

import javax.persistence.*;


@Entity
public class Member extends BaseEntity{

    public Member(){
    }

    public Member(Long id, String username){
        this.id = id;
        this.username = username;
    }

    @Id @GeneratedValue
    @Column(name = &quot;MEMBER_ID&quot;)
    private Long id;

    @Column(name = &quot;USERNAME&quot;)
    private String username;

    @ManyToOne
    @JoinColumn
    private Team team;


    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public Team getTeam() {
        return team;
    }

    public void setTeam(Team team) {
        this.team = team;
    }

}

</code></pre>
<blockquote>
<p>JpaMain.java</p>
</blockquote>
<pre><code>package relativemapping;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.EntityTransaction;
import javax.persistence.Persistence;
import java.time.LocalDateTime;
import java.util.List;

public class JpaMain {
    //psvm ë‹¨ì¶•í‚¤ë¡œ ìƒì„± ê°€ëŠ¥
    public static void main(String[] args) {
        EntityManagerFactory emf = Persistence.createEntityManagerFactory(&quot;relativemapping&quot;);
        EntityManager em = emf.createEntityManager();
        EntityTransaction tx = em.getTransaction();

        tx.begin(); // [íŠ¸ëœì­ì…˜] ì‹œì‘

        try{

            Team team = new Team();
            team.setName(&quot;TeamA&quot;);
            team.setCreateBy(&quot;kim&quot;);
            team.setCreateDate(LocalDateTime.now());
            em.persist(team);

            Member member = new Member();
            member.setUsername(&quot;MemberA&quot;);
            member.setCreateBy(&quot;kim&quot;);
            member.setCreateDate(LocalDateTime.now());
            member.setTeam(team);
            em.persist(member);
            em.flush();
            em.clear();

            Member findMember = em.find(Member.class, member.getId());

            tx.commit();

        }catch (Exception e){
            e.printStackTrace();
            tx.rollback();
        }finally {
            em.close();
        }
        emf.close();
    }

    private static void printMember(Member member){
        System.out.println(&quot;username = &quot;+member.getUsername());
    }

    private static void printMemberAndTeam(Member member){
        String username = member.getUsername();
        System.out.println(&quot;username = &quot;+username);

        Team team = member.getTeam();
        System.out.println(&quot;team = &quot;+team.getName());
    }
}


</code></pre>
<blockquote>
<p>console</p>
</blockquote>
<pre><code>Hibernate: 
    /* insert relativemapping.Team
        */ insert 
        into
            Team
            (MOD_ID, MOD_DT, REG_ID, REG_DT, NAME, TEAM_ID) 
        values
            (?, ?, ?, ?, ?, ?)
Hibernate: 
    /* insert relativemapping.Member
        */ insert 
        into
            Member
            (MOD_ID, MOD_DT, REG_ID, REG_DT, USERNAME, MEMBER_ID) 
        values
            (?, ?, ?, ?, ?, ?)
Hibernate: 
    select
        member0_.MEMBER_ID as member_i1_3_0_,
        member0_.MOD_ID as mod_id2_3_0_,
        member0_.MOD_DT as mod_dt3_3_0_,
        member0_.REG_ID as reg_id4_3_0_,
        member0_.REG_DT as reg_dt5_3_0_,
        member0_.TEAM_ID as team_id7_3_0_,
        member0_.USERNAME as username6_3_0_,
        team1_.TEAM_ID as team_id1_7_1_,
        team1_.MOD_ID as mod_id2_7_1_,
        team1_.MOD_DT as mod_dt3_7_1_,
        team1_.REG_ID as reg_id4_7_1_,
        team1_.REG_DT as reg_dt5_7_1_,
        team1_.NAME as name6_7_1_ 
    from
        Member member0_ 
    left outer join
        Team team1_ 
            on member0_.TEAM_ID=team1_.TEAM_ID 
    where
        member0_.MEMBER_ID=?
        
findMember.id = 2
findMember.userName = MemberA

</code></pre>
<blockquote>
<p>Memberì™€ Teamì´ Joinëœ ì¿¼ë¦¬ë¡œ Select ë˜ì–´ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.</p>
</blockquote>
<blockquote>
<p>JpaMain.java - em.find() -&gt; em.getReference(),<br>
//System.out.println(&ldquo;findMember.id = &ldquo;+findMember.getId()); // ì£¼ì„ì²˜ë¦¬ <br>
//System.out.println(&ldquo;findMember.userName = &ldquo;+findMember.getUsername()); // ì£¼ì„ì²˜ë¦¬</p>
</blockquote>
<pre><code>			 Team team = new Team();
            team.setName(&quot;TeamA&quot;);
            team.setCreateBy(&quot;kim&quot;);
            team.setCreateDate(LocalDateTime.now());
            em.persist(team);

            Member member = new Member();
            member.setUsername(&quot;MemberA&quot;);
            member.setCreateBy(&quot;kim&quot;);
            member.setCreateDate(LocalDateTime.now());
            member.setTeam(team);
            em.persist(member);
            em.flush();
            em.clear();

            //Member findMember = em.find(Member.class, member.getId());
            Member findMember = em.getReference(Member.class, member.getId());

            //System.out.println(&quot;findMember.id = &quot;+findMember.getId());
            //System.out.println(&quot;findMember.userName = &quot;+findMember.getUsername());

            //printMemberAndTeam(findMember);

            tx.commit();
</code></pre>
<blockquote>
<p>console</p>
</blockquote>
<pre><code>Hibernate: 
    /* insert relativemapping.Team
        */ insert 
        into
            Team
            (MOD_ID, MOD_DT, REG_ID, REG_DT, NAME, TEAM_ID) 
        values
            (?, ?, ?, ?, ?, ?)
Hibernate: 
    /* insert relativemapping.Member
        */ insert 
        into
            Member
            (MOD_ID, MOD_DT, REG_ID, REG_DT, USERNAME, MEMBER_ID) 
        values
            (?, ?, ?, ?, ?, ?)

</code></pre>
<blockquote>
<p>Select Sqlì´ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</blockquote>
<blockquote>
<p>JpaMain.java - em.find() -&gt; em.getReference(),<br>
System.out.println(&ldquo;findMember.id = &ldquo;+findMember.getId()); // ì£¼ì„í•´ì œ <br>
System.out.println(&ldquo;findMember.userName = &ldquo;+findMember.getUsername()); // ì£¼ì„í•´ì œ</p>
</blockquote>
<pre><code>			 Team team = new Team();
            team.setName(&quot;TeamA&quot;);
            team.setCreateBy(&quot;kim&quot;);
            team.setCreateDate(LocalDateTime.now());
            em.persist(team);

            Member member = new Member();
            member.setUsername(&quot;MemberA&quot;);
            member.setCreateBy(&quot;kim&quot;);
            member.setCreateDate(LocalDateTime.now());
            member.setTeam(team);
            em.persist(member);
            em.flush();
            em.clear();

            //Member findMember = em.find(Member.class, member.getId());
            Member findMember = em.getReference(Member.class, member.getId());
				
			 System.out.println(&quot;findMember.class = &quot;+findMember.getClass()); // í´ë˜ìŠ¤ í™•ì¸
            System.out.println(&quot;findMember.id = &quot;+findMember.getId()); // ì£¼ì„í•´ì œ 
            System.out.println(&quot;findMember.userName = &quot;+findMember.getUsername()); // ì£¼ì„í•´ì œ 

            //printMemberAndTeam(findMember);

            tx.commit();
</code></pre>
<blockquote>
<p>console</p>
</blockquote>
<pre><code>Hibernate: 
    /* insert relativemapping.Team
        */ insert 
        into
            Team
            (MOD_ID, MOD_DT, REG_ID, REG_DT, NAME, TEAM_ID) 
        values
            (?, ?, ?, ?, ?, ?)
Hibernate: 
    /* insert relativemapping.Member
        */ insert 
        into
            Member
            (MOD_ID, MOD_DT, REG_ID, REG_DT, USERNAME, MEMBER_ID) 
        values
            (?, ?, ?, ?, ?, ?)
            
findMember.class = class relativemapping.Member$HibernateProxy$kQ2LbNHi

findMember.id = 2

Hibernate: 
    select
        member0_.MEMBER_ID as member_i1_3_0_,
        member0_.MOD_ID as mod_id2_3_0_,
        member0_.MOD_DT as mod_dt3_3_0_,
        member0_.REG_ID as reg_id4_3_0_,
        member0_.REG_DT as reg_dt5_3_0_,
        member0_.TEAM_ID as team_id7_3_0_,
        member0_.USERNAME as username6_3_0_,
        team1_.TEAM_ID as team_id1_7_1_,
        team1_.MOD_ID as mod_id2_7_1_,
        team1_.MOD_DT as mod_dt3_7_1_,
        team1_.REG_ID as reg_id4_7_1_,
        team1_.REG_DT as reg_dt5_7_1_,
        team1_.NAME as name6_7_1_ 
    from
        Member member0_ 
    left outer join
        Team team1_ 
            on member0_.TEAM_ID=team1_.TEAM_ID 
    where
        member0_.MEMBER_ID=?
        
findMember.userName = MemberA

Process finished with exit code 0


</code></pre>
<blockquote>
<p>getReferance()ë¥¼ ìˆ˜í–‰í•˜ëŠ” ì‹œì ì—ëŠ” Select ì¿¼ë¦¬ë¥¼ ë‚ ë¦¬ì§€ ì•ŠìŒ. ì´ ê°’ì´ ì‹¤ì œ ì‚¬ìš©ë˜ëŠ” ì‹œì ì— Select ì¿¼ë¦¬ë¥¼ ìˆ˜í–‰í•´ DBë©”ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´. <br>
findMember.class = class relativemapping.Member$HibernateProxy$kQ2LbNHi Member.javaê°€ ì•„ë‹ˆë¼ HibernateProxy ì¸ê²ƒìœ¼ë¡œ í™•ì¸ë¨ <br>
JPAì—ì„œ ë§Œë“  ê°€ìƒì˜ í”„ë¡ì‹œ Class</p>
</blockquote>
<h4 id="í”„ë¡ì‹œ-ê¸°ì´ˆ-1">í”„ë¡ì‹œ ê¸°ì´ˆ<a class="anchor" href="#í”„ë¡ì‹œ-ê¸°ì´ˆ-1">#</a></h4>
<p><img src="/images/develop/backend/orm-jpa-basic/proxy-and-relation/img-002.png" alt="contact"></p>
<blockquote>
<p>em.getRefence() ë¥¼ ìˆ˜í–‰í•˜ë©´ í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” í”„ë¡ì‹œë¼ëŠ” ê°€ì§œ ì—”í‹°í‹° ê°ì²´ë¥¼ ë„˜ê²¨ì¤ë‹ˆë‹¤. <br>
ê»ë°ê¸°ëŠ” ë˜‘ê°™ì€ë° í……í…… ë¹ˆ ê°ì²´ë¡œ ë„˜ê²¨ì¤ë‹ˆë‹¤. ê·¸ë¦¬ê³  targetì´ë¼ëŠ” ì†ì„±ì´ ìˆëŠ”ë° ì´ê²Œ ì§„ì§œ ë ˆí¼ëŸ°ìŠ¤ ì…ë‹ˆë‹¤.</p>
</blockquote>
<h4 id="í”„ë¡ì‹œ-íŠ¹ì§•">í”„ë¡ì‹œ íŠ¹ì§•<a class="anchor" href="#í”„ë¡ì‹œ-íŠ¹ì§•">#</a></h4>
<blockquote>
<ul>
<li>ì‹¤ì œ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ì•„ì„œ ë§Œë“¤ì–´ì§</li>
<li>ì‹¤ì œ í´ë ˆìŠ¤ì™€ ê²‰ ëª¨ì–‘ì´ ê°™ë‹¤.</li>
<li>ì‚¬ìš©í•˜ëŠ” ì…ì¥ì—ì„œëŠ” ì§„ì§œ ê°ì²´ì¸ì§€ í”„ë¡ì‹œ ê°ì²´ì¸ì§€ êµ¬ë¶„ í•˜ì§€ ì•Šê³  ì‚¬ìš©í•˜ë©´ ë¨(ì´ë¡ ìƒ)</li>
</ul>
</blockquote>
<p><img src="/images/develop/backend/orm-jpa-basic/proxy-and-relation/img-003.png" alt="contact"></p>
<blockquote>
<ul>
<li>í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ì°¸ì¡°(target)ë¥¼ ë³´ê´€</li>
<li>í”„ë¡ì‹œ ê°ì²´ë¥¼ í˜¸ì¶œí•˜ë©´ í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ê°ì²´ì˜ ë©”ì†Œë“œ í˜¸ì¶œ</li>
</ul>
</blockquote>
<p><img src="/images/develop/backend/orm-jpa-basic/proxy-and-relation/img-004.png" alt="contact"></p>
<h4 id="í”„ë¡ì‹œ-ê°ì²´ì˜-ì´ˆê¸°í™”">í”„ë¡ì‹œ ê°ì²´ì˜ ì´ˆê¸°í™”<a class="anchor" href="#í”„ë¡ì‹œ-ê°ì²´ì˜-ì´ˆê¸°í™”">#</a></h4>
<pre><code>Member member = em.getReference(Member.class, 1L);
member.getName();
</code></pre>
<p><img src="/images/develop/backend/orm-jpa-basic/proxy-and-relation/img-005.png" alt="contact"></p>
<blockquote>
<p>JpaMain.java -</p>
</blockquote>
<pre><code>Team team = new Team();
            team.setName(&quot;TeamA&quot;);
            team.setCreateBy(&quot;kim&quot;);
            team.setCreateDate(LocalDateTime.now());
            em.persist(team);

            Member member = new Member();
            member.setUsername(&quot;MemberA&quot;);
            member.setCreateBy(&quot;kim&quot;);
            member.setCreateDate(LocalDateTime.now());
            member.setTeam(team);
            em.persist(member);
            em.flush();
            em.clear();

            //Member findMember = em.find(Member.class, member.getId());
            Member findMember = em.getReference(Member.class, member.getId());

            System.out.println(&quot;findMember.class = &quot;+findMember.getClass()); 
            System.out.println(&quot;findMember.id = &quot;+findMember.getId()); 
            System.out.println(&quot;findMember.userName = &quot;+findMember.getUsername());  // getUsername() í˜¸ì¶œ

            System.out.println(&quot;findMember.userName = &quot;+findMember.getUsername());  // getUsername() í˜¸ì¶œ 2

            tx.commit();

</code></pre>
<blockquote>
<p>console</p>
</blockquote>
<pre><code>Hibernate: 
    /* insert relativemapping.Team
        */ insert 
        into
            Team
            (MOD_ID, MOD_DT, REG_ID, REG_DT, NAME, TEAM_ID) 
        values
            (?, ?, ?, ?, ?, ?)
Hibernate: 
    /* insert relativemapping.Member
        */ insert 
        into
            Member
            (MOD_ID, MOD_DT, REG_ID, REG_DT, USERNAME, MEMBER_ID) 
        values
            (?, ?, ?, ?, ?, ?)
            
findMember.class = class relativemapping.Member$HibernateProxy$kQ2LbNHi

findMember.id = 2

Hibernate: 
    select
        member0_.MEMBER_ID as member_i1_3_0_,
        member0_.MOD_ID as mod_id2_3_0_,
        member0_.MOD_DT as mod_dt3_3_0_,
        member0_.REG_ID as reg_id4_3_0_,
        member0_.REG_DT as reg_dt5_3_0_,
        member0_.TEAM_ID as team_id7_3_0_,
        member0_.USERNAME as username6_3_0_,
        team1_.TEAM_ID as team_id1_7_1_,
        team1_.MOD_ID as mod_id2_7_1_,
        team1_.MOD_DT as mod_dt3_7_1_,
        team1_.REG_ID as reg_id4_7_1_,
        team1_.REG_DT as reg_dt5_7_1_,
        team1_.NAME as name6_7_1_ 
    from
        Member member0_ 
    left outer join
        Team team1_ 
            on member0_.TEAM_ID=team1_.TEAM_ID 
    where
        member0_.MEMBER_ID=?
        
findMember.userName = MemberA

findMember.userName = MemberA

Process finished with exit code 0


</code></pre>
<blockquote>
<p>í”„ë¡ì‹œ ìƒì„±í›„ findMember.userName()ë¥¼ ìœ„í•´ select SQLì„ í˜¸ì¶œí•˜ì§€ë§Œ, 2ë²ˆì§¸ findMember.userName() í˜¸ì¶œí• ë• targetì— ê°’ì´ ìˆê³  ì´ë¯¸ ì´ˆê¸°í™”ê°€ ë˜ì–´ ìˆëŠ” í”„ë¡ì‹œ ì´ê¸° ë•Œë¬¸ì— ì¡°íšŒì—†ì´ ê°’ì„ ì¶œë ¥í•˜ê²Œ ë©ë‹ˆë‹¤.</p>
</blockquote>
<h4 id="í”„ë¡ì‹œì˜-íŠ¹ì§•">í”„ë¡ì‹œì˜ íŠ¹ì§•<a class="anchor" href="#í”„ë¡ì‹œì˜-íŠ¹ì§•">#</a></h4>
<blockquote>
<ul>
<li>í”„ë¡ì‹œ ê°ì²´ëŠ” ì²˜ìŒ ì‚¬ìš©í•  ë•Œ í•œ ë²ˆë§Œ ì´ˆê¸°í™”</li>
<li>í”„ë¡ì‹œ ê°ì²´ë¥¼ ì´ˆê¸°í™” í•  ë•Œ, <mark>í”„ë¡ì‹œ ê°ì²´ê°€ ì‹¤ì œ ì—”í‹°í‹°ë¡œ ë°”ë€ŒëŠ” ê²ƒì€ ì•„ë‹˜</mark>, ì´ˆê¸°í™”ë˜ë©´ í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ì„œ ì‹¤ì œ ì—”í‹°í‹°ì— ì ‘ê·¼ ê°€ëŠ¥</li>
</ul>
</blockquote>
<h5 id="í”„ë¡ì‹œ-ê°ì²´ê°€-ì‹¤ì œ-ì—”í‹°í‹°ë¡œ-ë°”ë€ŒëŠ”-ê²ƒì€-ì•„ë‹˜">í”„ë¡ì‹œ ê°ì²´ê°€ ì‹¤ì œ ì—”í‹°í‹°ë¡œ ë°”ë€ŒëŠ” ê²ƒì€ ì•„ë‹˜<a class="anchor" href="#í”„ë¡ì‹œ-ê°ì²´ê°€-ì‹¤ì œ-ì—”í‹°í‹°ë¡œ-ë°”ë€ŒëŠ”-ê²ƒì€-ì•„ë‹˜">#</a></h5>
<blockquote>
<p>JpaMain.java - findMember.getUsername() ì „í›„ë¡œ findMember.getClass() ê°ì²´ íƒ€ì… í™•ì¸</p>
</blockquote>
<pre><code>			Team team = new Team();
            team.setName(&quot;TeamA&quot;);
            team.setCreateBy(&quot;kim&quot;);
            team.setCreateDate(LocalDateTime.now());
            em.persist(team);

            Member member = new Member();
            member.setUsername(&quot;MemberA&quot;);
            member.setCreateBy(&quot;kim&quot;);
            member.setCreateDate(LocalDateTime.now());
            member.setTeam(team);
            em.persist(member);
            em.flush();
            em.clear();

            //Member findMember = em.find(Member.class, member.getId());
            Member findMember = em.getReference(Member.class, member.getId());

            System.out.println(&quot;findMember.class before = &quot;+findMember.getClass());

            System.out.println(&quot;findMember.userName = &quot;+findMember.getUsername());

            System.out.println(&quot;findMember.class after = &quot;+findMember.getClass());

            //printMemberAndTeam(findMember);

            tx.commit();
</code></pre>
<blockquote>
<p>console</p>
</blockquote>
<pre><code>Hibernate: 
    call next value for hibernate_sequence
Hibernate: 
    call next value for hibernate_sequence
Hibernate: 
    /* insert relativemapping.Team
        */ insert 
        into
            Team
            (MOD_ID, MOD_DT, REG_ID, REG_DT, NAME, TEAM_ID) 
        values
            (?, ?, ?, ?, ?, ?)
Hibernate: 
    /* insert relativemapping.Member
        */ insert 
        into
            Member
            (MOD_ID, MOD_DT, REG_ID, REG_DT, USERNAME, MEMBER_ID) 
        values
            (?, ?, ?, ?, ?, ?)
findMember.class before = class relativemapping.Member$HibernateProxy$uziW0Tt8
Hibernate: 
    select
        member0_.MEMBER_ID as member_i1_3_0_,
        member0_.MOD_ID as mod_id2_3_0_,
        member0_.MOD_DT as mod_dt3_3_0_,
        member0_.REG_ID as reg_id4_3_0_,
        member0_.REG_DT as reg_dt5_3_0_,
        member0_.TEAM_ID as team_id7_3_0_,
        member0_.USERNAME as username6_3_0_,
        team1_.TEAM_ID as team_id1_7_1_,
        team1_.MOD_ID as mod_id2_7_1_,
        team1_.MOD_DT as mod_dt3_7_1_,
        team1_.REG_ID as reg_id4_7_1_,
        team1_.REG_DT as reg_dt5_7_1_,
        team1_.NAME as name6_7_1_ 
    from
        Member member0_ 
    left outer join
        Team team1_ 
            on member0_.TEAM_ID=team1_.TEAM_ID 
    where
        member0_.MEMBER_ID=?
findMember.userName = MemberA
findMember.class after = class relativemapping.Member$HibernateProxy$uziW0Tt8

Process finished with exit code 0

</code></pre>
<blockquote>
<ul>
<li>í”„ë¡ì‹œ ê°ì²´ëŠ” ì›ë³¸ ì—”í‹°í‹°ë¥¼ ìƒì†ë°›ìŒ, ë”°ë¼ì„œ íƒ€ì… ì²´í¬ì‹œ ì£¼ì˜í•´ì•¼í•¨ (==ë¹„êµ ì‹¤íŒ¨, ëŒ€ì‹  instance of ì‚¬ìš©)</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì°¾ëŠ” ì—”í‹°í‹°ê°€ ì´ë¯¸ ìˆìœ¼ë©´ em.getReference()ë¥¼ í˜¸ì¶œí•´ë„ ì‹¤ì œ ì—”í‹°í‹° ë°˜í™˜ (ë°˜ëŒ€ë¡œ em.getReference()ë¡œ ì¡°íšŒ í›„ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•˜ë©´ í”„ë¡ì‹œ ê°ì²´ë¡œ ë°˜í™˜)</li>
<li>ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë„ì›€ì„ ë°›ì„ ìˆ˜ ì—†ëŠ” ì¤€ì˜ì† ìƒíƒœì¼ ë•Œ, í”„ë¡ì‹œë¥¼ ì´ˆê¸°í™” í•˜ë©´ ë¬¸ì œ ë°œìƒ <br>
(í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” org.hivernate.LazyInitializationException ì˜ˆì™¸ë£° í„°íŠ¸ë¦¼)</li>
</ul>
</blockquote>
<h5 id="ì—”í‹°í‹°-ê°ì²´--ë¹„êµ">ì—”í‹°í‹° ê°ì²´ == ë¹„êµ<a class="anchor" href="#ì—”í‹°í‹°-ê°ì²´--ë¹„êµ">#</a></h5>
<blockquote>
<p>JpaMain.java - em.find(), em.find() íƒ€ì…ë¹„êµ</p>
</blockquote>
<pre><code>			Team team = new Team();
            team.setName(&quot;TeamA&quot;);
            team.setCreateBy(&quot;kim&quot;);
            team.setCreateDate(LocalDateTime.now());
            em.persist(team);

            Member member1 = new Member();
            member1.setUsername(&quot;MemberA&quot;);
            member1.setCreateBy(&quot;kim&quot;);
            member1.setCreateDate(LocalDateTime.now());
            member1.setTeam(team);
            em.persist(member1);
            Member member2 = new Member();
            member2.setUsername(&quot;MemberA&quot;);

            member2.setCreateBy(&quot;kim&quot;);
            member2.setCreateDate(LocalDateTime.now());
            member2.setTeam(team);
            em.persist(member2);


            em.flush();
            em.clear();

            Member m1 = em.find(Member.class, member1.getId());
            Member m2 = em.find(Member.class, member2.getId());

			
            System.out.println(&quot;m1 == m2 &quot; + (m1.getClass() == m2.getClass())); // m1 == m2true
</code></pre>
<h5 id="ì—”í‹°í‹°-ê°ì²´-í”„ë¡ì‹œ-ê°ì²´--ë¹„êµ">ì—”í‹°í‹° ê°ì²´, í”„ë¡ì‹œ ê°ì²´ == ë¹„êµ<a class="anchor" href="#ì—”í‹°í‹°-ê°ì²´-í”„ë¡ì‹œ-ê°ì²´--ë¹„êµ">#</a></h5>
<blockquote>
<p>JpaMain.java - em.find(), em.getReference() íƒ€ì…ë¹„êµ</p>
</blockquote>
<pre><code>		    Member m1 = em.find(Member.class, member1.getId());
            Member m2 = em.getReference(Member.class, member2.getId());

            System.out.println(&quot;m1 == m2 &quot; + (m1.getClass() == m2.getClass()));
// m1 == m2 false
</code></pre>
<blockquote>
<p>ë¹„êµí•œ em.findë¡œ ê°€ì ¸ì˜¨ ì—”í‹°í‹° ê°ì²´ì™€ getReferenceë¥¼ í†µí•´ ë§Œë“  í”„ë¡ì‹œ ê°ì²´ëŠ” == ë¹„êµë¥¼ í•˜ë©´ falseë¡œ ë‚˜ì˜µë‹ˆë‹¤. <br>
ì§€ê¸ˆì´ì•¼ ê°™ì€ JpaMainì—ì„œ ë³´ë©´ ì‰½ê² ì§€ë§Œ ì•„ë˜ì™€ ê°™ì€ ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•œë‹¤ë©´ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì–´ë–¤ ê°ì²´ê°€ ë„˜ì–´ì˜¤ëŠ”ì§€ ì•Œê¸° í˜ë“­ë‹ˆë‹¤.</p>
</blockquote>
<blockquote>
<p>JpaMain.java - ë©”ì†Œë“œë¥¼ ìƒì„±í•˜ê³  ë‚´ë¶€ì—ì„œ ê°ì²´ == ë¹„êµ</p>
</blockquote>
<pre><code>	...
	
	logic(m1,m2);
    ...
   
    private static void logic(Member m1, Member m2) {
        System.out.println(&quot;m1 == m2 &quot; + (m1.getClass() == m2.getClass())); 
    }
	
</code></pre>
<h5 id="í”„ë¡ì‹œ-ê°ì²´-instanceof-ì²´í¬">í”„ë¡ì‹œ ê°ì²´ instanceof ì²´í¬<a class="anchor" href="#í”„ë¡ì‹œ-ê°ì²´-instanceof-ì²´í¬">#</a></h5>
<blockquote>
<p>JpaMain.java - ë©”ì†Œë“œë¥¼ ìƒì„±í•˜ê³  ë‚´ë¶€ì—ì„œ ê°ì²´ instanceofë¡œ ì²´í¬</p>
</blockquote>
<pre><code>    ...
	
    logic(m1,m2);
    ...
    
   
   private static void logic(Member m1, Member m2) {
        System.out.println(&quot;m1 instanceof Member &quot; + (m1 instanceof Member));
        System.out.println(&quot;m2 instanceof Member &quot; + (m2 instanceof Member));
    }

</code></pre>
<h5 id="ì˜ì†ì„±-ì»¨í…ìŠ¤íŠ¸1ì°¨-ìºì‹œì—-ì°¾ëŠ”-ì—”í‹°í‹°ê°€-ìˆìœ¼ë©´-emgetreferenceë¥¼-í˜¸ì¶œí•´ë„-ì‹¤ì œ-ì—”í‹°í‹°-ë°˜í™˜">ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(1ì°¨ ìºì‹œ)ì— ì°¾ëŠ” ì—”í‹°í‹°ê°€ ìˆìœ¼ë©´ em.getReference()ë¥¼ í˜¸ì¶œí•´ë„ ì‹¤ì œ ì—”í‹°í‹° ë°˜í™˜<a class="anchor" href="#ì˜ì†ì„±-ì»¨í…ìŠ¤íŠ¸1ì°¨-ìºì‹œì—-ì°¾ëŠ”-ì—”í‹°í‹°ê°€-ìˆìœ¼ë©´-emgetreferenceë¥¼-í˜¸ì¶œí•´ë„-ì‹¤ì œ-ì—”í‹°í‹°-ë°˜í™˜">#</a></h5>
<blockquote>
<p>JpaMain.java - ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì—”í‹°í‹° ì¶”ê°€ í›„ em.getReference()</p>
</blockquote>
<pre><code>          Team team = new Team();
            team.setName(&quot;TeamA&quot;);
            team.setCreateBy(&quot;kim&quot;);
            team.setCreateDate(LocalDateTime.now());
            em.persist(team);

            Member member1 = new Member();
            member1.setUsername(&quot;MemberA&quot;);
            member1.setCreateBy(&quot;kim&quot;);
            member1.setCreateDate(LocalDateTime.now());
            member1.setTeam(team);
            em.persist(member1);
            Member member2 = new Member();
            member2.setUsername(&quot;MemberA&quot;);

            member2.setCreateBy(&quot;kim&quot;);
            member2.setCreateDate(LocalDateTime.now());
            member2.setTeam(team);
            em.persist(member2);


            em.flush();
            em.clear();

            Member r1 = em.getReference(Member.class, member1.getId());
            System.out.println(&quot;r1 = &quot; + r1.getClass());

            Member r2 = em.getReference(Member.class,member1.getId());

            System.out.println(&quot;r2 = &quot; + r2.getClass());
            
            System.out.println(&quot;r1 == r2 &quot; + (r1 == r2));

            tx.commit();

</code></pre>
<blockquote>
<p>console</p>
</blockquote>
<pre><code>  select
        member0_.MEMBER_ID as member_i1_3_0_,
        member0_.MOD_ID as mod_id2_3_0_,
        member0_.MOD_DT as mod_dt3_3_0_,
        member0_.REG_ID as reg_id4_3_0_,
        member0_.REG_DT as reg_dt5_3_0_,
        member0_.TEAM_ID as team_id7_3_0_,
        member0_.USERNAME as username6_3_0_,
        team1_.TEAM_ID as team_id1_7_1_,
        team1_.MOD_ID as mod_id2_7_1_,
        team1_.MOD_DT as mod_dt3_7_1_,
        team1_.REG_ID as reg_id4_7_1_,
        team1_.REG_DT as reg_dt5_7_1_,
        team1_.NAME as name6_7_1_ 
    from
        Member member0_ 
    left outer join
        Team team1_ 
            on member0_.TEAM_ID=team1_.TEAM_ID 
    where
        member0_.MEMBER_ID=?
        
m1 = class relativemapping.Member

r1 = class relativemapping.Member

m1 == r1 true

</code></pre>
<blockquote>
<p>m1ê³¼ r1 ëª¨ë‘ Member ì—”í‹°í‹° ê°ì²´ í´ë˜ìŠ¤ë¡œ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‘ê°€ì§€ ì´ìœ ê°€ ìˆëŠ”ë° í•˜ë‚˜ëŠ” <br>
ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì´ë¯¸ ìˆëŠ”ë° í”„ë¡ì‹œë¡œ ê°€ì ¸ ì™€ë´ì•¼ ì´ì ì´ ì—†ëŠ”ë° í”„ë¡ì‹œë¡œ ê°€ì ¸ì˜¬ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ì›ë³¸ì¸ ì—”í‹°í‹° ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ”ê²Œ ë” ì„±ëŠ¥ ìµœì í™”ì— ë„ì›€ì´ ë©ë‹ˆë‹¤.</p>
</blockquote>
<blockquote>
<p>ë˜í•œ JPAì—ì„œëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì•ˆì—ì„œ ê°™ì€ Memberë¥¼ ì—”í‹°í‹°ì—ì„œ ì¡°íšŒí•˜ê±°ë‚˜, ë ˆí¼ëŸ°ìŠ¤ë¡œ ì¡°íšŒí•´ ì™€ë„ ì»¬ë ‰ì…˜ì—ì„œ == ë¹„êµí•œ ê²ƒì²˜ëŸ¼ ê°™ì€ ê°’ìœ¼ë¡œ ì¸ì‹í•´ ì¤ë‹ˆë‹¤.</p>
</blockquote>
<blockquote>
<p>JPAëŠ” í•œ íŠ¸ëœì ì…˜ ì•ˆì—ì„œ ê°™ì€ ê°ì²´ì— ëŒ€í•œ ë³´ì¥ì„ í•´ì¤ë‹ˆë‹¤.</p>
</blockquote>
<blockquote>
<p>r1 ê³¼ r2  ë‘˜ë‹¤ ë ˆí¼ëŸ°ìŠ¤ë©´ ë‘ê°œì˜ í”„ë¡ì‹œ ê°ì²´ëŠ” ë™ì¼í•˜ê³ , == ë¹„êµì‹œ true ë¥¼ ë°˜í™˜ í•©ë‹ˆë‹¤.</p>
</blockquote>
<pre><code>            Member r1 = em.getReference(Member.class, member1.getId());
            System.out.println(&quot;r1 = &quot; + r1.getClass());

            Member r2 = em.getReference(Member.class,member1.getId());

            System.out.println(&quot;r2 = &quot; + r2.getClass());
            
            System.out.println(&quot;r1 == r2 &quot; + (r1 == r2));

</code></pre>
<blockquote>
<p>console</p>
</blockquote>
<pre><code>	r1 = class relativemapping.Member$HibernateProxy$3dvhAszH
	r2 = class relativemapping.Member$HibernateProxy$3dvhAszH
	r1 == r2 true
</code></pre>
<blockquote>
<p>JpaMain.java - ë ˆí¼ëŸ°ìŠ¤ë¡œ ì¡°íšŒ í›„ ì¼ë°˜ ì—”í‹°í‹° ì¡°íšŒ ì‹œ</p>
</blockquote>
<pre><code>			Member r1 = em.getReference(Member.class, member1.getId());
            System.out.println(&quot;r1 = &quot; + r1.getClass());

            Member m1 = em.find(Member.class,member1.getId());

            System.out.println(&quot;m1 = &quot; + m1.getClass());

            System.out.println(&quot;r1 == m1 &quot; + (r1 == m1));
</code></pre>
<blockquote>
<p>console</p>
</blockquote>
<pre><code>r1 = class relativemapping.Member$HibernateProxy$vH2td1yz
Hibernate: 
    select
        member0_.MEMBER_ID as member_i1_3_0_,
        member0_.MOD_ID as mod_id2_3_0_,
        member0_.MOD_DT as mod_dt3_3_0_,
        member0_.REG_ID as reg_id4_3_0_,
        member0_.REG_DT as reg_dt5_3_0_,
        member0_.TEAM_ID as team_id7_3_0_,
        member0_.USERNAME as username6_3_0_,
        team1_.TEAM_ID as team_id1_7_1_,
        team1_.MOD_ID as mod_id2_7_1_,
        team1_.MOD_DT as mod_dt3_7_1_,
        team1_.REG_ID as reg_id4_7_1_,
        team1_.REG_DT as reg_dt5_7_1_,
        team1_.NAME as name6_7_1_ 
    from
        Member member0_ 
    left outer join
        Team team1_ 
            on member0_.TEAM_ID=team1_.TEAM_ID 
    where
        member0_.MEMBER_ID=?
        
m1 = class relativemapping.Member$HibernateProxy$vH2td1yz

r1 == m1 true

</code></pre>
<blockquote>
<p>em.getReference() ì´í›„ em.find()ë˜í•œ proxyë¡œ ì¡°íšŒëœê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ê°™ì€ ì»¨í…ìŠ¤íŠ¸ ì•ˆì—ì„œ ê°™ì€ ê°ì²´ë¡œ ë°˜í™˜í•´ ì£¼ëŠ” JPAì˜ íŠ¹ì§•ì…ë‹ˆë‹¤.</p>
</blockquote>
<h5 id="ì˜ì†ì„±-ì»¨í…ìŠ¤íŠ¸ì˜-ë„ì›€ì„-ë°›ì„-ìˆ˜-ì—†ëŠ”-ì¤€ì˜ì†-ìƒíƒœì¼-ë•Œ-í”„ë¡ì‹œë¥¼-ì´ˆê¸°í™”í•˜ë©´-ë¬¸ì œ-ë°œìƒ">ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë„ì›€ì„ ë°›ì„ ìˆ˜ ì—†ëŠ” ì¤€ì˜ì† ìƒíƒœì¼ ë•Œ, í”„ë¡ì‹œë¥¼ ì´ˆê¸°í™”í•˜ë©´ ë¬¸ì œ ë°œìƒ<a class="anchor" href="#ì˜ì†ì„±-ì»¨í…ìŠ¤íŠ¸ì˜-ë„ì›€ì„-ë°›ì„-ìˆ˜-ì—†ëŠ”-ì¤€ì˜ì†-ìƒíƒœì¼-ë•Œ-í”„ë¡ì‹œë¥¼-ì´ˆê¸°í™”í•˜ë©´-ë¬¸ì œ-ë°œìƒ">#</a></h5>
<blockquote>
<p>JpaaAin.java - ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì œê±°ëœ ê²½ìš°  <br>
getReference() í›„ getUsername()ì„ í†µí•´ ì´ˆê¸°í™”</p>
</blockquote>
<pre><code>     	  Team team = new Team();
            team.setName(&quot;TeamA&quot;);
            team.setCreateBy(&quot;kim&quot;);
            team.setCreateDate(LocalDateTime.now());
            em.persist(team);

            Member member1 = new Member();
            member1.setUsername(&quot;MemberA&quot;);
            member1.setCreateBy(&quot;kim&quot;);
            member1.setCreateDate(LocalDateTime.now());
            member1.setTeam(team);
            em.persist(member1);
            Member member2 = new Member();
            member2.setUsername(&quot;MemberA&quot;);

            member2.setCreateBy(&quot;kim&quot;);
            member2.setCreateDate(LocalDateTime.now());
            member2.setTeam(team);
            em.persist(member2);


            em.flush();
            em.clear();

            Member r1 = em.getReference(Member.class, member1.getId());
            System.out.println(&quot;r1 = &quot; + r1.getClass());


            em.detach(r1); // ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ r1ì„ ì œê±°
            //  em.clear();

            r1.getUsername(); //ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì œê±°ëœ ê²½ìš°

            tx.commit();
</code></pre>
<blockquote>
<p>console</p>
</blockquote>
<pre><code>Hibernate: 
    /* insert relativemapping.Team
        */ insert 
        into
            Team
            (MOD_ID, MOD_DT, REG_ID, REG_DT, NAME, TEAM_ID) 
        values
            (?, ?, ?, ?, ?, ?)
Hibernate: 
    /* insert relativemapping.Member
        */ insert 
        into
            Member
            (MOD_ID, MOD_DT, REG_ID, REG_DT, USERNAME, MEMBER_ID) 
        values
            (?, ?, ?, ?, ?, ?)
Hibernate: 
    /* insert relativemapping.Member
        */ insert 
        into
            Member
            (MOD_ID, MOD_DT, REG_ID, REG_DT, USERNAME, MEMBER_ID) 
        values
            (?, ?, ?, ?, ?, ?)
r1 = class relativemapping.Member$HibernateProxy$Sq3ipbiV

org.hibernate.LazyInitializationException: could not initialize proxy [relativemapping.Member#2] - no Session //ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì—†ë‹¤ëŠ” ì´ì•¼ê¸°
	at org.hibernate.proxy.AbstractLazyInitializer.initialize(AbstractLazyInitializer.java:170)
	at org.hibernate.proxy.AbstractLazyInitializer.getImplementation(AbstractLazyInitializer.java:310)
	at org.hibernate.proxy.pojo.bytebuddy.ByteBuddyInterceptor.intercept(ByteBuddyInterceptor.java:45)
	at org.hibernate.proxy.ProxyConfiguration$InterceptorDispatcher.intercept(ProxyConfiguration.java:95)
	at relativemapping.Member$HibernateProxy$Sq3ipbiV.getUsername(Unknown Source)
	at relativemapping.JpaMain.main(JpaMain.java:52)
</code></pre>
<blockquote>
<p>JpaaAin.java - ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ì¢…ë£Œëœê²½ìš°
getReference() í›„ getUsername()ì„ í†µí•´ ì´ˆê¸°í™”</p>
</blockquote>
<pre><code>     	  Team team = new Team();
            team.setName(&quot;TeamA&quot;);
            team.setCreateBy(&quot;kim&quot;);
            team.setCreateDate(LocalDateTime.now());
            em.persist(team);

            Member member1 = new Member();
            member1.setUsername(&quot;MemberA&quot;);
            member1.setCreateBy(&quot;kim&quot;);
            member1.setCreateDate(LocalDateTime.now());
            member1.setTeam(team);
            em.persist(member1);
            Member member2 = new Member();
            member2.setUsername(&quot;MemberA&quot;);

            member2.setCreateBy(&quot;kim&quot;);
            member2.setCreateDate(LocalDateTime.now());
            member2.setTeam(team);
            em.persist(member2);


            em.flush();
            em.clear();

            Member r1 = em.getReference(Member.class, member1.getId());
            System.out.println(&quot;r1 = &quot; + r1.getClass());


            em.close(); // ì»¨í…ìŠ¤íŠ¸ ì¢…ë£Œ

            r1.getUsername(); //ì»¨í…ìŠ¤íŠ¸ ì¢…ë£Œëœ ì´í›„ í”„ë¡ì‹œ ê°ì²´ ì´ˆê¸°í™”

            tx.commit();
</code></pre>
<blockquote>
<p>console</p>
</blockquote>
<pre><code>Hibernate: 
    /* insert relativemapping.Team
        */ insert 
        into
            Team
            (MOD_ID, MOD_DT, REG_ID, REG_DT, NAME, TEAM_ID) 
        values
            (?, ?, ?, ?, ?, ?)
Hibernate: 
    /* insert relativemapping.Member
        */ insert 
        into
            Member
            (MOD_ID, MOD_DT, REG_ID, REG_DT, USERNAME, MEMBER_ID) 
        values
            (?, ?, ?, ?, ?, ?)
Hibernate: 
    /* insert relativemapping.Member
        */ insert 
        into
            Member
            (MOD_ID, MOD_DT, REG_ID, REG_DT, USERNAME, MEMBER_ID) 
        values
            (?, ?, ?, ?, ?, ?)
r1 = class relativemapping.Member$HibernateProxy$t0KzgTxZ
Hibernate: 
    select
        member0_.MEMBER_ID as member_i1_3_0_,
        member0_.MOD_ID as mod_id2_3_0_,
        member0_.MOD_DT as mod_dt3_3_0_,
        member0_.REG_ID as reg_id4_3_0_,
        member0_.REG_DT as reg_dt5_3_0_,
        member0_.TEAM_ID as team_id7_3_0_,
        member0_.USERNAME as username6_3_0_,
        team1_.TEAM_ID as team_id1_7_1_,
        team1_.MOD_ID as mod_id2_7_1_,
        team1_.MOD_DT as mod_dt3_7_1_,
        team1_.REG_ID as reg_id4_7_1_,
        team1_.REG_DT as reg_dt5_7_1_,
        team1_.NAME as name6_7_1_ 
    from
        Member member0_ 
    left outer join
        Team team1_ 
            on member0_.TEAM_ID=team1_.TEAM_ID 
    where
        member0_.MEMBER_ID=?
1ì›” 26, 2022 10:57:16 ì˜¤í›„ org.hibernate.engine.jdbc.connections.internal.DriverManagerConnectionProviderImpl$PoolState stop
INFO: HHH10001008: Cleaning up connection pool [jdbc:h2:tcp://localhost/~/test]

Process finished with exit code 0

</code></pre>
<blockquote>
<p>ê°•ì˜ì— ì˜í•˜ë©´ LazyInitializationException( &ldquo;could not initialize proxy  - the owning Session was closed&rdquo; ) exceptionì´ ë‚˜ì™€ì•¼ í•˜ì§€ë§Œ,  <br></p>
</blockquote>
<blockquote>
<p>5.4.0.Final ë²„ì „ê¹Œì§€ëŠ” ì˜ˆì™¸ê°€ ë°œìƒí•˜ëŠ”ë° 5.4.1.Final ë²„ì „ë¶€í„° ì˜ˆì™¸ê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. <br></p>
</blockquote>
<blockquote>
<p>íŠ¸ëœì­ì…˜ì„ ì¢…ë£Œí•˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ì„¸ì…˜(ì—”í‹°í‹°ë©”ë‹ˆì ¸)ì„ ë‹«ì•˜ê¸° ë•Œë¬¸ì— ì•„ì§ íŠ¸ëœì­ì…˜ì´ ì‚´ì•„ìˆìŠµë‹ˆë‹¤.</p>
</blockquote>
<h4 id="í”„ë¡ì‹œ-í™•ì¸">í”„ë¡ì‹œ í™•ì¸<a class="anchor" href="#í”„ë¡ì‹œ-í™•ì¸">#</a></h4>
<blockquote>
<ul>
<li>í”„ë¡ì‹œ ì¸ìŠ¤í„´ìŠ¤ ì´ˆê¸°í™” ì—¬ë¶€ í™•ì¸
PersistenceUnitUtil.isLoaded(Object entity)</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>í”„ë¡ì‹œ í´ë˜ìŠ¤ í™•ì¸ ë°©ë²•
entity.getClass().getName() ì¶œë ¥ (&hellip;javasist&hellip;or HibernateProxy..)</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>í”„ë¡ì‹œ ê°•ì œ ì´ˆê¸°í™”
org.hibernate.initialize(entity);</li>
</ul>
</blockquote>
<blockquote>
<p>ì°¸ê³  :JPA í‘œì¤€ì€ ê°•ì œ ì´ˆê¸°í™” ì—†ìŒ
ê°•ì œ í˜¸ì¶œ : member.getName()</p>
</blockquote>
<h5 id="í”„ë¡ì‹œ-ì¸ìŠ¤í„´ìŠ¤-ì´ˆê¸°í™”-ì—¬ë¶€-í™•ì¸">í”„ë¡ì‹œ ì¸ìŠ¤í„´ìŠ¤ ì´ˆê¸°í™” ì—¬ë¶€ í™•ì¸<a class="anchor" href="#í”„ë¡ì‹œ-ì¸ìŠ¤í„´ìŠ¤-ì´ˆê¸°í™”-ì—¬ë¶€-í™•ì¸">#</a></h5>
<blockquote>
<p>JpaMain.java - emf.getPersistenceUnitUtil().isLoaded() ì‚¬ìš©</p>
</blockquote>
<pre><code>
	  	  Team team = new Team();
            team.setName(&quot;TeamA&quot;);
            team.setCreateBy(&quot;kim&quot;);
            team.setCreateDate(LocalDateTime.now());
            em.persist(team);

            Member member1 = new Member();
            member1.setUsername(&quot;MemberA&quot;);
            member1.setCreateBy(&quot;kim&quot;);
            member1.setCreateDate(LocalDateTime.now());
            member1.setTeam(team);
            em.persist(member1);
            Member member2 = new Member();
            member2.setUsername(&quot;MemberA&quot;);

            member2.setCreateBy(&quot;kim&quot;);
            member2.setCreateDate(LocalDateTime.now());
            member2.setTeam(team);
            em.persist(member2);


            em.flush();
            em.clear();

            Member r1 = em.getReference(Member.class, member1.getId());
            System.out.println(&quot;r1 = &quot; + r1.getClass());

            //ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ì—ì„œ PersistenceUnitUtilë¥¼ ë°›ì•„ì™€ ì‚¬ìš©
            System.out.println(&quot;isLoaded = &quot;+ emf.getPersistenceUnitUtil().isLoaded(r1) );

            r1.getUsername();

            System.out.println(&quot;isLoaded = &quot;+ emf.getPersistenceUnitUtil().isLoaded(r1) );


            tx.commit();
            
</code></pre>
<blockquote>
<p>console</p>
</blockquote>
<pre><code>
Hibernate: 
    /* insert relativemapping.Member
        */ insert 
        into
            Member
            (MOD_ID, MOD_DT, REG_ID, REG_DT, USERNAME, MEMBER_ID) 
        values
            (?, ?, ?, ?, ?, ?)
            
r1 = class relativemapping.Member$HibernateProxy$qay0PhKw //í”„ë¡ì‹œ ìƒì„±

isLoaded = false // í”„ë¡ì‹œ ì´ˆê¸°í™”ì „ false

Hibernate: 
    select
        member0_.MEMBER_ID as member_i1_3_0_,
        member0_.MOD_ID as mod_id2_3_0_,
        member0_.MOD_DT as mod_dt3_3_0_,
        member0_.REG_ID as reg_id4_3_0_,
        member0_.REG_DT as reg_dt5_3_0_,
        member0_.TEAM_ID as team_id7_3_0_,
        member0_.USERNAME as username6_3_0_,
        team1_.TEAM_ID as team_id1_7_1_,
        team1_.MOD_ID as mod_id2_7_1_,
        team1_.MOD_DT as mod_dt3_7_1_,
        team1_.REG_ID as reg_id4_7_1_,
        team1_.REG_DT as reg_dt5_7_1_,
        team1_.NAME as name6_7_1_ 
    from
        Member member0_ 
    left outer join
        Team team1_ 
            on member0_.TEAM_ID=team1_.TEAM_ID 
    where
        member0_.MEMBER_ID=?
        
isLoaded = true // í”„ë¡ì‹œ ì´ˆê¸°í™”ì „ true

</code></pre>
<h5 id="í”„ë¡ì‹œ-í™•ì¸-ë°©ë²•">í”„ë¡ì‹œ í™•ì¸ ë°©ë²•<a class="anchor" href="#í”„ë¡ì‹œ-í™•ì¸-ë°©ë²•">#</a></h5>
<blockquote>
<p>JpaMain.java</p>
</blockquote>
<pre><code>
		System.out.println(&quot;r1 = &quot; + r1.getClass());

</code></pre>
<p>console</p>
<pre><code>
r1 = class relativemapping.Member$HibernateProxy$qay0PhKw

</code></pre>
<h5 id="í”„ë¡ì‹œ-ê°•ì œ-ì´ˆê¸°í™”">í”„ë¡ì‹œ ê°•ì œ ì´ˆê¸°í™”<a class="anchor" href="#í”„ë¡ì‹œ-ê°•ì œ-ì´ˆê¸°í™”">#</a></h5>
<blockquote>
<p>JpaMain.java</p>
</blockquote>
<pre><code>
		   r1.getUsername(); // í”„ë¡ì‹œ ê°•ì œ ì´ˆê¸°í™” (í•˜ì´ë²„ë„¤ì´íŠ¸, í‘œì¤€ JPA)
		   
		   //Hibernate.initialize(r1); //í•˜ì´ë²„ë„¤ì´íŠ¸ only

            System.out.println(&quot;isLoaded = &quot;+ emf.getPersistenceUnitUtil().isLoaded(r1) );

</code></pre>
<p>console</p>
<pre><code>
Hibernate: 
    select
        member0_.MEMBER_ID as member_i1_3_0_,
        member0_.MOD_ID as mod_id2_3_0_,
        member0_.MOD_DT as mod_dt3_3_0_,
        member0_.REG_ID as reg_id4_3_0_,
        member0_.REG_DT as reg_dt5_3_0_,
        member0_.TEAM_ID as team_id7_3_0_,
        member0_.USERNAME as username6_3_0_,
        team1_.TEAM_ID as team_id1_7_1_,
        team1_.MOD_ID as mod_id2_7_1_,
        team1_.MOD_DT as mod_dt3_7_1_,
        team1_.REG_ID as reg_id4_7_1_,
        team1_.REG_DT as reg_dt5_7_1_,
        team1_.NAME as name6_7_1_ 
    from
        Member member0_ 
    left outer join
        Team team1_ 
            on member0_.TEAM_ID=team1_.TEAM_ID 
    where
        member0_.MEMBER_ID=?
        
isLoaded = true

</code></pre>
<h4 id="ì°¸ê³ --a-hrefhttpswwwinflearncomcourseorm-jpa-basicìë°”-orm-í‘œì¤€-jpa---ê¹€ì˜í•œa">ì°¸ê³ - <a href="https://www.inflearn.com/course/ORM-JPA-Basic">ìë°” ORM í‘œì¤€ JPA - ê¹€ì˜í•œ</a><a class="anchor" href="#ì°¸ê³ --a-hrefhttpswwwinflearncomcourseorm-jpa-basicìë°”-orm-í‘œì¤€-jpa---ê¹€ì˜í•œa">#</a></h4>


              
          </article>
          
          
            
            	 

<ul class="tags__list">
    
    <li class="tag__item">
        <a class="tag__link" href="https://offetuoso.github.io/tags/java/">Java</a>
    </li>
    <li class="tag__item">
        <a class="tag__link" href="https://offetuoso.github.io/tags/jpa/">JPA</a>
    </li>
    <li class="tag__item">
        <a class="tag__link" href="https://offetuoso.github.io/tags/orm/">ORM</a>
    </li>
    <li class="tag__item">
        <a class="tag__link" href="https://offetuoso.github.io/tags/%EC%9D%B8%ED%94%84%EB%9F%B0/">ì¸í”„ëŸ°</a>
    </li>
    <li class="tag__item">
        <a class="tag__link" href="https://offetuoso.github.io/tags/%EA%B9%80%EC%98%81%ED%95%9C/">ê¹€ì˜í•œ</a>
    </li>
    </ul>

 
		          <div class="pagination">
  
    <a class="pagination__item" href="https://offetuoso.github.io/blog/develop/backend/orm-jpa-basic/practical-example-4/">
        <span class="pagination__label">Previous Post</span>
        <span class="pagination__title">JPA ì‹¤ì „ ì˜ˆì œ 4 - ìƒì†ê´€ê³„ ë§¤í•‘</span>
    </a>
  

  
    <a class="pagination__item" href="https://offetuoso.github.io/blog/develop/backend/orm-jpa-basic/eager-loading-and-lazy-loading/">
      <span class="pagination__label">Next Post</span>
      <span class="pagination__title" >JPA ì¦‰ì‹œ ë¡œë”©ê³¼ ì§€ì—°ë¡œë”©</span>
    </a>
  
</div>

		          <script src="https://utteranc.es/client.js"
        repo="offetuoso/offetuoso.github.io"
        issue-term="pathname"
        label="âœ¨ğŸ’¬âœ¨"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
		
		          <footer class="post__footer">
		            


<div class="social-icons">
  
     
    
      <a class="social-icons__link" rel="me" title="GitHub"
         href="https://github.com/offetuoso"
         target="_blank" rel="noopener">
        <div class="social-icons__icon icon_github" style="background-image: url('https://offetuoso.github.io/svg/github.svg')"></div>
      </a>
    
  
     
    
      <a class="social-icons__link" rel="me" title="Email"
         href="mailto:kihun.oh.developer@gmail.com,offetuoso@gmail.com,offetuoso@naver.com"
         target="_blank" rel="noopener">
        <div class="social-icons__icon icon_email" style="background-image: url('https://offetuoso.github.io/svg/email.svg')"></div>
      </a>
    
  
     
    
      <a class="social-icons__link" rel="me" title="Instagram"
         href="https://instagram.com/offetuoso"
         target="_blank" rel="noopener">
        <div class="social-icons__icon icon_instagram" style="background-image: url('https://offetuoso.github.io/svg/instagram.svg')"></div>
      </a>
    
  
     
    
      <a class="social-icons__link" rel="me" title="search"
         href="#"
         target="_blank" rel="noopener">
        <div class="social-icons__icon icon_search" style="background-image: url('https://offetuoso.github.io/svg/search.svg')"></div>
      </a>
    
     
</div>

		            <p>Â© 2021</p>
		          </footer>
            
            
            
          
         
          
          
          </div>
      </div>
      
      <div class="toc-container">
          <div class="toc-post-title">JPA í”„ë¡ì‹œì™€ ì—°ê´€ê´€ê³„</div> 
        <nav id="TableOfContents">
  <ul>
    <li><a href="#ëª©ì°¨">ëª©ì°¨</a>
      <ul>
        <li><a href="#í”„ë¡ì‹œ">í”„ë¡ì‹œ</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
      
    </div>
    

  </main>

   

  
  <script src="/js/index.min.f22abd4553ae420dba1bb2319da56f1d71ca94b6ce33b89dd67c0021e792b21c.js" integrity="sha256-8iq9RVOuQg26G7IxnaVvHXHKlLbOM7id1nwAIeeSshw=" crossorigin="anonymous"></script>
  
  
  <script src="https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js"></script>

  
  <script src="https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js"
    data-autoloader-path="https://unpkg.com/prismjs@1.20.0/components/"></script>

  
    <script src="/js/table-of-contents.js"></script>
  


  
  
<script id="search-result-template" type="text/x-js-template">
    <article class="list__item post search-result-list" id="summary-${key}">
      <header class="list__header">
        <h3 class="list__title post__title ">
          <a href="${link}" rel="bookmark">
            ${title} 
          </a>         
        </h3>
        <div class="list__meta meta">
          <div class="meta__item-categories meta__item">
            <svg class="meta__icon icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
            <span class="meta__text">
              ${ isset tags } ${tags} ${ end }
            </span>
          </div>
        </div>
      </header>
      <div class="content list__excerpt post__content clearfix">
        ${snippet}
      </div>
    </article>
</script>
</body>

</html>
